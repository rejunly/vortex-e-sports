<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Loja Vortex E-sports</title>
  <link rel="icon" href="img/logo.jpeg" type="image/png"> <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Russo+One&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

  <link rel="stylesheet" href="/static/shop_style.css">

</head>

<body>
  <header>
      <nav class="navbar">
        <a href="#" class="logo">
          <img
            src="{{ url_for('static', filename='FOTOS/logo.png') }}"
            alt="Logo Time Vortex"
          />
          <span>VORTEX</span>
        </a>

        <ul class="nav-links">
          <l1><a href="{{ url_for('home') }}">HOME</a></l1>
          <li class="dropdown">
            <a> TIME VORTEX <i class="fas fa-chevron-down"></i> </a>
            <ul class="dropdown-menu">
              <li><a href="{{ url_for('timevortex') }}">Sobre o Time</a></li>
              <li><a href="{{ url_for('transmission') }}">Transmissão ao Vivo</a></li>
            </ul>
          </li>
          <li><a href="{{ url_for('shop') }}">SHOP</a></li>
          <li><a href="#contato">CONTATO</a></li>
        </ul>

        <div class="navbar-right">
          <a href="#" class="login-button">ENTRAR</a>
          <a href="#" class="nav-icon"><i class="fas fa-shopping-cart"></i></a>
          <a href="#" class="nav-icon"><i class="fas fa-search"></i></a>
          <a href="#" class="nav-icon"><i class="fas fa-user"></i></a>
        </div>
      </nav>
    </header>

  <section class="hero">
    <h1>VORTEX ARMORY</h1>
    <p>Equipe-se como um profissional. Vista as cores da tempestade e domine o jogo!</p>
  </section>

  <main class="produtos">
    <h2 class="section-title">NOSSA COLEÇÃO</h2>
    <div class="grid-produtos">
      <div class="produto-card" data-id="1" data-name="Camisa Oficial Vortex" data-price="119.90" data-img="img/img1.jpg">
        <img src="/static/img-vendas/fone.jpeg" alt="Camisa Vortex">
        <div class="produto-info">
          <h3>Camisa Oficial Vortex</h3>
          <p>Tecido dry-fit, confortável e estilosa.</p>
          <div class="preco">R$ 119,90</div>
          <button class="btn-comprar">Adicionar ao Carrinho</button>
        </div>
      </div>
      <div class="produto-card" data-id="2" data-name="Mousepad Gamer Vortex" data-price="69.90" data-img="img/img2.webp">
        <img src="/static/img-vendas/meia.jpeg" alt="Mousepad Vortex">
        <div class="produto-info">
          <h3>Mousepad Gamer Vortex</h3>
          <p>Alta precisão e base antiderrapante.</p>
          <div class="preco">R$ 69,90</div>
          <button class="btn-comprar">Adicionar ao Carrinho</button>
        </div>
      </div>
      <div class="produto-card" data-id="3" data-name="Boné Vortex" data-price="79.90" data-img="img/img3.jpg">
        <img src="/static/img-vendas/img3.jpg" alt="Boné Vortex">
        <div class="produto-info">
          <h3>Boné Vortex</h3>
          <p>Design moderno e ajustável.</p>
          <div class="preco">R$ 79,90</div>
          <button class="btn-comprar">Adicionar ao Carrinho</button>
        </div>
      </div>
      <div class="produto-card" data-id="4" data-name="Moletom Hoodie Vortex" data-price="189.90" data-img="img/img4.jpg">
        <img src="/static/img-vendas/img4.jpg" alt="Hoodie Vortex">
        <div class="produto-info">
          <h3>Moletom Hoodie Vortex</h3>
          <p>Conforto e estilo nas suas partidas.</p>
          <div class="preco">R$ 189,90</div>
          <button class="btn-comprar">Adicionar ao Carrinho</button>
        </div>
      </div>
    </div>
  </main>

  <div class="carrinho" id="carrinho">
    <div class="carrinho-header">
      <h2>Seu Carrinho</h2>
      <button class="btn-fechar" id="fecharCarrinho"><i class="fas fa-times"></i></button>
    </div>
    <div id="itensCarrinho">
    </div>
    <div class="carrinho-footer">
      <div class="total">Total: <span id="totalValor">R$ 0,00</span></div>
      <button class="btn-finalizar">Finalizar Compra</button>
      <button class="btn-limpar">Esvaziar Carrinho</button>
    </div>
  </div>

  <div id="toast" class="toast">Item adicionado com sucesso!</div>
  
  <div id="modal-finalizar" class="modal-overlay">
    <div class="modal-content">
      <i class="fas fa-check-circle"></i>
      <h2>Compra Finalizada!</h2>
      <p>Obrigado por apoiar a Vortex! Em breve você receberá os detalhes por e-mail.</p>
      <button id="fecharModal">Entendido</button>
    </div>
  </div>

  <footer>
    <div class="footer-content">
      <img src="/static/img-vendas/ifrn.png" alt="IFRN Campus Apodi">
      <p><strong>Vortex E-sports</strong> é um projeto orgulhosamente desenvolvido por alunos do <strong>IFRN - Campus Apodi</strong> para a II Semana de Informática.</p>
      <p>&copy; 2025 Vortex E-sports. Todos os direitos reservados.</p>
    </div>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- SELETORES DO DOM ---
        const btnCarrinho = document.getElementById('btnCarrinho');
        const fecharCarrinho = document.getElementById('fecharCarrinho');
        const carrinhoContainer = document.getElementById('carrinho');
        const gridProdutos = document.querySelector('.grid-produtos');
        const itensCarrinhoContainer = document.getElementById('itensCarrinho');
        const totalValorEl = document.getElementById('totalValor');
        const cartCountEl = document.getElementById('cart-count');
        const toastEl = document.getElementById('toast');
        const btnLimpar = document.querySelector('.btn-limpar');
        const btnFinalizar = document.querySelector('.btn-finalizar');
        const modal = document.getElementById('modal-finalizar');
        const fecharModal = document.getElementById('fecharModal');
        
        // --- ESTADO DA APLICAÇÃO ---
        let cart = JSON.parse(localStorage.getItem('vortexCart')) || [];

        // --- FUNÇÕES ---

        const saveCart = () => {
            localStorage.setItem('vortexCart', JSON.stringify(cart));
        };

        const formatCurrency = (value) => {
            return `R$ ${value.toFixed(2).replace('.', ',')}`;
        };

        const showToast = (message) => {
            toastEl.textContent = message;
            toastEl.classList.add('show');
            setTimeout(() => toastEl.classList.remove('show'), 3000);
        };

        const updateCartUI = () => {
            itensCarrinhoContainer.innerHTML = ''; // Limpa o carrinho
            let total = 0;
            let totalItems = 0;

            if (cart.length === 0) {
                itensCarrinhoContainer.innerHTML = `
                    <div class="carrinho-vazio">
                        <i class="fas fa-shopping-cart"></i>
                        <p>Seu carrinho está vazio.</p>
                    </div>
                `;
            } else {
                cart.forEach(item => {
                    const itemEl = document.createElement('div');
                    itemEl.classList.add('item-carrinho');
                    itemEl.innerHTML = `
                        <img src="${item.img}" alt="${item.name}">
                        <div class="item-info">
                            <span>${item.name}</span>
                            <strong>${formatCurrency(item.price)}</strong>
                            <div class="quantidade-controls">
                                <button class="diminuir-qtd" data-id="${item.id}">-</button>
                                <span>${item.quantity}</span>
                                <button class="aumentar-qtd" data-id="${item.id}">+</button>
                            </div>
                        </div>
                        <button class="btn-remover" data-id="${item.id}"><i class="fas fa-trash-alt"></i></button>
                    `;
                    itensCarrinhoContainer.appendChild(itemEl);
                    total += item.price * item.quantity;
                });
            }
            
            cart.forEach(item => totalItems += item.quantity);
            totalValorEl.textContent = formatCurrency(total);
            cartCountEl.textContent = totalItems;
            saveCart();
        };

        const addToCart = (product) => {
            const existingItem = cart.find(item => item.id === product.id);
            if (existingItem) {
                existingItem.quantity++;
            } else {
                cart.push({ ...product, quantity: 1 });
            }
            showToast(`${product.name} foi adicionado!`);
            updateCartUI();
        };
        
        const changeQuantity = (productId, change) => {
            const item = cart.find(item => item.id === productId);
            if(item) {
                item.quantity += change;
                if(item.quantity <= 0) {
                    cart = cart.filter(cartItem => cartItem.id !== productId);
                }
            }
            updateCartUI();
        };

        const clearCart = () => {
            cart = [];
            updateCartUI();
        };

        // --- EVENT LISTENERS ---

        btnCarrinho.addEventListener('click', () => carrinhoContainer.classList.add('ativo'));
        fecharCarrinho.addEventListener('click', () => carrinhoContainer.classList.remove('ativo'));

        gridProdutos.addEventListener('click', (e) => {
            if (e.target.classList.contains('btn-comprar')) {
                const card = e.target.closest('.produto-card');
                const product = {
                    id: card.dataset.id,
                    name: card.dataset.name,
                    price: parseFloat(card.dataset.price),
                    img: card.dataset.img,
                };
                addToCart(product);
            }
        });
        
        itensCarrinhoContainer.addEventListener('click', (e) => {
            const id = e.target.closest('button')?.dataset.id;
            if(!id) return;
            
            if (e.target.closest('.aumentar-qtd')) {
                changeQuantity(id, 1);
            } else if (e.target.closest('.diminuir-qtd')) {
                changeQuantity(id, -1);
            } else if (e.target.closest('.btn-remover')) {
                cart = cart.filter(item => item.id !== id);
                updateCartUI();
            }
        });
        
        btnLimpar.addEventListener('click', clearCart);
        
        btnFinalizar.addEventListener('click', () => {
            if (cart.length > 0) {
                modal.classList.add('show');
            } else {
                showToast("Seu carrinho está vazio!");
            }
        });
        
        fecharModal.addEventListener('click', () => {
             modal.classList.remove('show');
             clearCart();
             carrinhoContainer.classList.remove('ativo');
        });

        // --- INICIALIZAÇÃO ---
        updateCartUI();
    });
  </script>
</body>
</html>
